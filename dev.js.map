{"version":3,"file":"dev.js","sources":["../src/utils/components.ts","../src/utils/constants.ts","../src/utils/scroll.ts","../src/utils/svg.ts","../src/formats/mermaid-code-block.ts","../src/formats/mermaid-editor.ts","../src/formats/mermaid-container.ts","../src/formats/mermaid-chart.ts","../src/utils/id.ts","../src/modules/mermaid-selector.ts","../src/index.ts"],"sourcesContent":[null,null,null,null,null,null,null,null,null,null,null],"names":["events","dataKey","Symbol","addScrollEvent","dom","handle","addEventListener","this","scrollHandler","push","clearScrollEvent","i","length","removeEventListener","Delta","Quill","import","CodeBlock","MermaidCodeBlock","static","cacheDelta","delta","Container","MermaidEditorFormat","register","blotName","create","value","node","super","lines","split","codeContainer","document","createElement","classList","add","line","code","textContent","appendChild","constructor","scroll","domNode","MutationObserver","emitter","emit","SCROLL_UPDATE","observe","attributes","characterData","characterDataOldValue","childList","subtree","window","mermaid","initialize","startOnLoad","MermaidContainerFormat","mode","getChart","children","tail","getEditor","head","createEditor","chart","editor","on","updateChart","insertBefore","text","descendants","map","join","removeEditor","remove","off","switchMode","BlockEmbed","async","renderMermaidChart","id","result","parse","render","base64","string","doc","DOMParser","parseFromString","XMLSerializer","serializeToString","querySelector","svgStringToBase64","svg","img","Image","src","btoa","innerHTML","error","console","message","MermaidChartFormat","setAttribute","Math","random","toString","slice","dataset","close","target","mask","icon","createLoading","Promise","resolve","MermaidSelector","quill","mermaidBlot","options","toolbox","selector","internalDestroy","resizeOb","resolveOptions","addContainer","createSelector","Object","assign","onDestroy","classes","el","classname","updateSelector","mermaidRect","getBoundingClientRect","x","y","targetRect","container","containerRect","scrollLeft","scrollTop","x1","width","y1","height","getRelativeRect","root","style","left","top","call","ResizeObserver","editBtn","createBtnIcon","iconStr","click","destroy","removeBtn","disconnect","undefined","btn","CodeBlockContainer","requiredContainer","allowedChildren","defaultChild","QuillMermaid","bindInHead","key","collapsed","format","prefix","suffix","handler","range","context","parent","offset","getLine","index","retain","insert","updateContents","sources","USER","setSelection","SILENT","mermaidSelector","toolbar","getModule","addHandler","getSelection","insertEmbed","keyboard","values","keyboradHandler","bindings","unshift","addBinding","evt","isEnabled","path","composedPath","chartNode","find","updateMermaidSelector","destroyMermaidSelector"],"mappings":"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"}