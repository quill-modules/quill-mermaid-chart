{"version":3,"file":"dev.js","sources":["../src/utils/constants.ts","../src/utils/id.ts","../src/utils/input.ts","../src/utils/scroll.ts","../src/formats/mermaid-chart.ts","../src/modules/mermaid-edit.ts","../src/index.ts"],"sourcesContent":[null,null,null,null,null,null,null],"names":["events","randomId","Math","random","toString","slice","CONTEXT_STYLE","addScrollEvent","dom","handle","addEventListener","this","scrollHandler","push","clearScrollEvent","i","length","removeEventListener","BlockEmbed","Quill","import","async","renderMermaidChart","id","value","container","result","window","mermaid","parse","render","innerHTML","svg","error","console","message","initialize","startOnLoad","MermaidChartFormat","static","create","node","super","setAttribute","dataset","chart","document","createElement","classList","add","appendChild","Promise","resolve","domNode","mode","editor","getChart","querySelector","createEditor","text","e","stopPropagation","code","preventDefault","resizeTextarea","blur","setTimeout","focus","removeEditor","remove","undefined","switchMode","style","display","scroll","emitter","emit","textarea","textareaStyle","targetElement","getComputedStyle","boxSizing","getPropertyValue","paddingSize","Number","parseFloat","borderSize","contextStyle","map","name","join","hiddenTextarea","body","placeholder","height","scrollHeight","minHeight","max","parentNode","removeChild","calcTextareaHeight","Object","assign","MermaidEdit","quill","mermaidBlot","options","toolbox","selector","internalDestroy","resizeOb","constructor","resolveOptions","addContainer","createSelector","onDestroy","classes","el","classname","split","updateSelector","mermaidRect","getBoundingClientRect","x","y","targetRect","containerRect","scrollLeft","scrollTop","x1","width","y1","getRelativeRect","root","left","top","call","ResizeObserver","observe","editBtn","createBtnIcon","iconStr","click","destroy","removeBtn","on","off","disconnect","btn","icon","icons","register","blotName","mermaidSelector","toolbar","getModule","addHandler","range","getSelection","insertEmbed","index","evt","isEnabled","path","composedPath","chartNode","find","updateMermaidSelector","destroyMermaidSelector","TEXT_CHANGE"],"mappings":"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"}